<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Using Ethermint with Truffle</title><meta name="description" content="This month I participated in the Cosmos Hackatom Hackathon. Cosmos is a company out of Tendermint who has created a protocol for making…"><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Using Ethermint with Truffle</h1>
</header>
<section data-field="subtitle" class="p-summary">
This month I participated in the Cosmos Hackatom Hackathon. Cosmos is a company out of Tendermint who has created a protocol for making…
</section>
<section data-field="body" class="e-content">
<section name="0992" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="ac39" id="ac39" class="graf graf--h3 graf--leading graf--title">Using Ethermint with Truffle</h3><figure name="c914" id="c914" class="graf graf--figure graf-after--h3"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 394px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 56.3%;"></div><img class="graf-image" data-image-id="1*onk4OapE4TL25G1Sb4VQBw.png" data-width="3840" data-height="2160" src="https://cdn-images-1.medium.com/max/800/1*onk4OapE4TL25G1Sb4VQBw.png"></div></figure><p name="dd27" id="dd27" class="graf graf--p graf-after--figure">This month I participated in the <a href="http://www.hackathon.io/cosmos-hackathon1" data-href="http://www.hackathon.io/cosmos-hackathon1" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Cosmos Hackatom Hackathon</a>. <a href="https://cosmos.network" data-href="https://cosmos.network" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Cosmos</a> is a company out of <a href="https://tendermint.com" data-href="https://tendermint.com" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Tendermint</a> who has created a protocol for making transactions on blockchains without incurring the huge costs of traditional mining (in electricity or miner fees) by using another method for consensus (Byzantine Fault Tolerance which is apparently vulnerable to untrustworthy nodes but whose achilles heel can be solved with Proof of Stake). One example of this Application BlockChain Interface (ABCI) is the creation of <a href="https://github.com/tendermint/ethermint" data-href="https://github.com/tendermint/ethermint" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Ethermint</a>, a Tendermint powered version of the Ethereum Blockchain.</p><p name="ef49" id="ef49" class="graf graf--p graf-after--p">The project I worked on for the hackathon needs to take a series of moves from the board game Reversi and play the game inside of an Ethereum Contract in order to confirm the game is valid. If the game is valid and the endgame forms a symmetrical board the user receives a reward in an ERC20 Token (Reversi-Search as Proof-Of-Work™). Even though the game is relatively simple to program, it includes lots of loops and arrays which are VERY expensive on the EVM, so naturally Ethermint would be a huge boon to the project (If you’re interested in how to reduce costs by avoiding arrays check out <a href="https://medium.com/p/reducing-eth-gas-23x-by-converting-arrays-to-bytes-ccf3b46daea5" data-href="https://medium.com/p/reducing-eth-gas-23x-by-converting-arrays-to-bytes-ccf3b46daea5" class="markup--anchor markup--p-anchor" target="_blank">this technique</a> and if you’re interested in the project check it out at <a href="https://clovers.network/" data-href="https://clovers.network/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">clovers.network</a> – <strong class="markup--strong markup--p-strong">Update: </strong><a href="https://blog.cosmos.network/announcement-hackatom-2-winners-d31fe584b70b" data-href="https://blog.cosmos.network/announcement-hackatom-2-winners-d31fe584b70b" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><strong class="markup--strong markup--p-strong">We won a prize</strong></a><strong class="markup--strong markup--p-strong">!</strong>).</p><figure name="4cb0" id="4cb0" class="graf graf--figure graf-after--p graf--trailing"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 380px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 54.2%;"></div><img class="graf-image" data-image-id="1*yWhw5_TdBD8KZ61d78130A.png" data-width="1440" data-height="781" src="https://cdn-images-1.medium.com/max/800/1*yWhw5_TdBD8KZ61d78130A.png"></div></figure></div></div></section><section name="e05b" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="8ebd" id="8ebd" class="graf graf--h3 graf--leading">Installation</h3><p name="636e" id="636e" class="graf graf--p graf-after--h3">Install instructions are found on the <a href="https://github.com/tendermint/ethermint" data-href="https://github.com/tendermint/ethermint" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">github repo</a>, it says you can download a binary from <a href="https://github.com/tendermint/ethermint/releases/tag/v0.2.2" data-href="https://github.com/tendermint/ethermint/releases/tag/v0.2.2" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">here</a> but there was no Mac version listed so I followed the Install From Source instructions. First you need get Go, they recommended using <a href="https://github.com/moovweb/gvm" data-href="https://github.com/moovweb/gvm" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">gvm</a>—which was great because it handles aliases and I seem to always have trouble with aliases — remembering if I need to update <code class="markup--code markup--p-code">$PATH</code> in the terminal, in <code class="markup--code markup--p-code">.bash_profile</code>, in <code class="markup--code markup--p-code">.baschrc</code>, restart the terminal, flush something??</p><p name="9c62" id="9c62" class="graf graf--p graf-after--p">The next parts were pretty straightforward and went off without a hitch following their instructions to first install <a href="https://github.com/tendermint/ethermint#source" data-href="https://github.com/tendermint/ethermint#source" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Ethermint</a>, then <a href="https://github.com/tendermint/ethermint#tendermint" data-href="https://github.com/tendermint/ethermint#tendermint" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Tendermint</a>, then <a href="https://github.com/tendermint/ethermint#initialisation" data-href="https://github.com/tendermint/ethermint#initialisation" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">initialize them</a> with default files and finally <a href="https://github.com/tendermint/ethermint#running" data-href="https://github.com/tendermint/ethermint#running" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">run the damn thing</a>. This is where I started having trouble, I got both programs to run in different terminal windows following their recommended start commands:</p><pre name="8442" id="8442" class="graf graf--pre graf-after--p">tendermint --home ~/.ethermint/tendermint node</pre><p name="5785" id="5785" class="graf graf--p graf-after--pre">which spits out red errors until you switch to a new terminal window and do:</p><pre name="3af4" id="3af4" class="graf graf--pre graf-after--p">ethermint --datadir ~/.ethermint --rpc --rpcaddr=0.0.0.0 --ws --wsaddr=0.0.0.0 --rpcapi eth,net,web3,personal,admin</pre><p name="6d4c" id="6d4c" class="graf graf--p graf-after--pre">The results look pretty similar to the few times I’d tried running Geth on my machine. The instructions said I could use Truffle without any extra arguments so I gave it a shot—no go.</p><pre name="1586" id="1586" class="graf graf--pre graf-after--p">truffle compile<br>truffle migrate</pre><pre name="a8b6" id="a8b6" class="graf graf--pre graf-after--pre">...</pre><pre name="e4e9" id="e4e9" class="graf graf--pre graf-after--pre graf--trailing">Error encountered, bailing. Network state unknown. Review successful transactions manually.<br>Error: authentication needed: password or unlock</pre></div></div></section><section name="cd9c" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="8f63" id="8f63" class="graf graf--h3 graf--leading">Unlocking</h3><p name="87df" id="87df" class="graf graf--p graf-after--h3">So I guess I need to unlock Ethermint first, I wasn’t even sure what my wallet address was so I looked into the <code class="markup--code markup--p-code">~/.ethermint</code> directory I’d installed earlier and found a <code class="markup--code markup--p-code">keystore</code> that Itook to <a href="https://www.myetherwallet.com/#view-wallet-info" data-href="https://www.myetherwallet.com/#view-wallet-info" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">myetherwallet.com</a>. I realized that since the <code class="markup--code markup--p-code">keystore</code> was in a hidden folder it wouldn’t be present in the Finder dialogue but googled a helpful shortcut of <strong class="markup--strong markup--p-strong">Command-Shift-Period to make Finder show hidden files.</strong> I uploaded the <code class="markup--code markup--p-code">keystore</code>, unlocked it with <strong class="markup--strong markup--p-strong">1234</strong> and found my address. Now equipped I went back and tried:</p><pre name="1379" id="1379" class="graf graf--pre graf-after--p">ethermint --datadir ~/.ethermint --rpc --rpcaddr=0.0.0.0 --ws --wsaddr=0.0.0.0 --rpcapi eth,net,web3,personal,admin --unlock 0xMY4W350M3W411374DDR355</pre><p name="1951" id="1951" class="graf graf--p graf-after--pre">but got <code class="markup--code markup--p-code">Fatal: Error starting protocol stack: resource temporarily unavailable.</code> I’ve had trouble with geth after stopping and starting, realizing it actually stayed alive somewhere in the background 👻, so I tried to find a kill command.<code class="markup--code markup--p-code">killall -9 ethermint</code> seemed to do the trick 💀. After starting Ethermint again the red errors inside of Tendermint didn’t stop and Ethermint kept repeating <code class="markup--code markup--p-code u-paddingRight0 u-marginRight0">Waiting for tendermint endpoint to start err=”Post <a href="http://localhost:46657/status" data-href="http://localhost:46657/status" class="markup--anchor markup--p-anchor" rel="nofollow" target="_blank">http://localhost:46657/status</a>: dial tcp [::1]:46657: getsockopt: connection refused”</code>. I force stopped Tendermint (<code class="markup--code markup--p-code">Control-C</code>) then tried it again but realized it too lived on somewhere <code class="markup--code markup--p-code">panic: Panicked on a Sanity Check: Error initializing DB: resource temporarily unavailable </code>killed it 🔪<code class="markup--code markup--p-code">killall -9 tendermint</code> and tried it all again:</p><pre name="d591" id="d591" class="graf graf--pre graf-after--p">tendermint --home ~/.ethermint/tendermint node</pre><pre name="284a" id="284a" class="graf graf--pre graf-after--pre">ethermint --datadir ~/.ethermint --rpc --rpcaddr=0.0.0.0 --ws --wsaddr=0.0.0.0 --rpcapi eth,net,web3,personal,admin  – unlock 0xMY4W350M3W411374DDR355</pre><p name="11f9" id="11f9" class="graf graf--p graf-after--pre">still got over and over again:</p><pre name="571c" id="571c" class="graf graf--pre graf-after--p">INFO [09-16|23:13:26] Waiting for tendermint endpoint to start err=&quot;Post <a href="http://localhost:46657/status" data-href="http://localhost:46657/status" class="markup--anchor markup--pre-anchor" rel="nofollow" target="_blank">http://localhost:46657/status</a>: dial tcp [::1]:46657: getsockopt: connection refused&quot;</pre><figure name="3f21" id="3f21" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 214px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 30.599999999999998%;"></div><img class="graf-image" data-image-id="1*DOdrD03dBoFu47P_0fNGgg.png" data-width="1069" data-height="327" src="https://cdn-images-1.medium.com/max/800/1*DOdrD03dBoFu47P_0fNGgg.png"></div></figure><h3 name="9a32" id="9a32" class="graf graf--h3 graf-after--figure">Assistance</h3><p name="684b" id="684b" class="graf graf--p graf-after--h3">As a last resort I went over to cosmos.rocket.chat where Cosmos employees let you bother them and got ahold of very helpful <a href="https://medium.com/u/a02fdd9c9222" data-href="https://medium.com/u/a02fdd9c9222" data-anchor-type="2" data-user-id="a02fdd9c9222" data-action-value="a02fdd9c9222" data-action="show-user-card" data-action-type="hover" class="markup--user markup--p-user" target="_blank">Adrian Brink</a> who told me I just type the password right into the oncoming mess of <code class="markup--code markup--p-code">waiting for tendermint</code> and duh it worked, all errors and red text stopped. Afterwards I ran <code class="markup--code markup--p-code">truffle compile &amp;&amp; truffle migrate</code> and I got a successful deploy 🎉</p><p name="c4cc" id="c4cc" class="graf graf--p graf-after--p graf--trailing">Now I’m able to get super fast confirmations at tiny gas prices using my dApp with Mist. I’m running my node locally so I’m the only user right now, but once Ethermint’s public test net is ready (October?) I could deploy there and launch the app publicly. Seem’s all that’s left now is getting Ethermint to <a href="https://github.com/tendermint/ethermint/issues/214" data-href="https://github.com/tendermint/ethermint/issues/214" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">play nice</a> with MetaMask 🦊</p></div></div></section>
</section>
<footer><p class="p-tags">Tagged in <a href="https://medium.com/tag/ethereum" class="p-tag">Ethereum</a>, <a href="https://medium.com/tag/tendermint" class="p-tag">Tendermint</a>, <a href="https://medium.com/tag/ethermint" class="p-tag">Ethermint</a>, <a href="https://medium.com/tag/cosmos" class="p-tag">Cosmos</a>, <a href="https://medium.com/tag/gas-prices" class="p-tag">Gas Prices</a></p><p>By <a href="https://medium.com/@billyrennekamp" class="p-author h-card">billy rennekamp</a> on <a href="https://medium.com/p/984e6721e30d"><time class="dt-published" datetime="2017-09-18T08:13:43.307Z">September 18, 2017</time></a>.</p><p><a href="https://medium.com/@billyrennekamp/using-ethermint-with-truffle-984e6721e30d" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on April 23, 2018.</p></footer></article>

</body></html>