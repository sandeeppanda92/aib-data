<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>ABCI: The Application BlockChain Interface</title><meta name="description" content="ABCI lets you create blockchain application easily in any languge. This post describes the motivation behind ABCI and links to tutorials…"><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">ABCI: The Application BlockChain Interface</h1>
</header>
<section data-field="subtitle" class="p-summary">
ABCI lets you create blockchain application easily in any languge. This post describes the motivation behind ABCI and links to tutorials…
</section>
<section data-field="body" class="e-content">
<section name="c531" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="dcb7" id="dcb7" class="graf graf--h3 graf--leading graf--title">ABCI: The Application BlockChain Interface</h3><h4 name="77b7" id="77b7" class="graf graf--h4 graf-after--h3 graf--subtitle">ABCI lets you create blockchain application easily in any languge. This post describes the motivation behind ABCI and links to tutorials. By <a href="https://medium.com/u/c010ef5a0ddf" data-href="https://medium.com/u/c010ef5a0ddf" data-anchor-type="2" data-user-id="c010ef5a0ddf" data-action-value="c010ef5a0ddf" data-action="show-user-card" data-action-type="hover" class="markup--user markup--h4-user" target="_blank">Jae Kwon</a></h4><p name="8126" id="8126" class="graf graf--p graf-after--h4">Thus far, all blockchains “stacks” (such as <a href="https://github.com/bitcoin/bitcoin" data-href="https://github.com/bitcoin/bitcoin" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Bitcoin</a>) have had a monolithic design. That is, each blockchain stack is a single program that handles all the concerns of a decentralized ledger; this includes P2P connectivity, the “mempool” broadcasting of transactions, consensus on the most recent block, account balances, Turing-complete contracts, user-level permissions, etc.</p><p name="cc56" id="cc56" class="graf graf--p graf-after--p">This approach to blockchain development has several problems. First, creating a new blockchain requires forking an existing blockchain stack, and this comes with the cost of complexity. First you need to understand all the components of a blockchain stack, even those that aren’t directly relevant to the logic of your application. This is especially true when the codebase is not modular in design and suffers from “spaghetti code”.</p><p name="3156" id="3156" class="graf graf--p graf-after--p">Another problem with this approach is that it limits you to the language of the blockchain stack (or vice versa). In the case of Ethereum which supports a Turing-complete bytecode virtual-machine, it limits you to languages that compile down to that bytecode; today, those are Serpent and Solidity.</p><p name="09db" id="09db" class="graf graf--p graf-after--p">In contrast, our approach is to decouple the consensus engine and P2P layers from the details of the application state of the particular blockchain application.</p><h3 name="462b" id="462b" class="graf graf--h3 graf-after--p">Intro to ABCI</h3><p name="c267" id="c267" class="graf graf--p graf-after--h3"><a href="https://github.com/tendermint/tendermint" data-href="https://github.com/tendermint/tendermint" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Tendermint Core</a> (the “consensus engine”) speaks to the application via an interface called <a href="https://github.com/tendermint/abci" data-href="https://github.com/tendermint/abci" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">ABCI</a>.</p><p name="e8be" id="e8be" class="graf graf--p graf-after--p">To draw an analogy, lets talk about a well-known cryptocurrency, Bitcoin. Bitcoin is a cryptocurrency blockchain where each node maintains a fully audited Unspent Transaction Output (UTXO) database. If one wanted to create a Bitcoin-like system on top of ABCI, Tendermint Core would be responsible for</p><ul class="postList"><li name="ac31" id="ac31" class="graf graf--li graf-after--p">Sharing blocks and transactions between nodes</li><li name="ea5d" id="ea5d" class="graf graf--li graf-after--li">Establishing a canonical/immutable order of transactions (the blockchain)</li></ul><p name="c809" id="c809" class="graf graf--p graf-after--li">The application will be responsible for</p><ul class="postList"><li name="6912" id="6912" class="graf graf--li graf-after--p">Maintaining the UTXO database</li><li name="a86d" id="a86d" class="graf graf--li graf-after--li">Validating cryptographic signatures of transactions</li><li name="340a" id="340a" class="graf graf--li graf-after--li">Preventing transactions from spending non-existent transactions</li><li name="b157" id="b157" class="graf graf--li graf-after--li">Allowing clients to query the UTXO database.</li></ul><p name="8dfb" id="8dfb" class="graf graf--p graf-after--li">Tendermint is able to decompose the blockchain design by offering a very simple API between the application process and consensus process.</p><p name="b437" id="b437" class="graf graf--p graf-after--p">The ABCI consists of 3 primary message types that get delivered from the core to the application. The application replies with corresponding response messages.</p><p name="49e2" id="49e2" class="graf graf--p graf-after--p">The messages are specified here: <a href="https://github.com/tendermint/abci#message-types" data-href="https://github.com/tendermint/abci#message-types" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">https://github.com/tendermint/abci#message-types</a></p><p name="fcdc" id="fcdc" class="graf graf--p graf-after--p">The <code class="markup--code markup--p-code">DeliverTx</code> message is the work horse of the application. Each transaction in the blockchain is delivered with this message. The application needs to validate each transactions received with the <code class="markup--code markup--p-code">DeliverTx</code> message against the current state, application protocol, and the cryptographic credentials of the transaction. A validated transaction then needs to update the application state — by binding a value into a key values store, or by updating the UTXO database.</p><p name="3691" id="3691" class="graf graf--p graf-after--p">The <code class="markup--code markup--p-code">CheckTx</code> message is similar to <code class="markup--code markup--p-code">DeliverTx</code>, but it&#39;s only for validating transactions. Tendermint Core&#39;s mempool first checks the validity of a transaction with <code class="markup--code markup--p-code">CheckTx</code>, and only relays valid transactions to its peers. Applications may check an incrementing nonce in the transaction and return an error upon <code class="markup--code markup--p-code">CheckTx</code> if the nonce is old.</p><p name="dcd5" id="dcd5" class="graf graf--p graf-after--p">The <code class="markup--code markup--p-code">Commit</code> message is used to compute a cryptographic commitment to the current application state, to be placed into the next block header. This has some handy properties. Inconsistencies in updating that state will now appear as blockchain forks which catches a whole class of programming errors. This also simplifies the development of secure lightweight clients, as Merkle-hash proofs can be verified by checking against the block hash, and the block hash is signed by a quorum of validators.</p><p name="78b4" id="78b4" class="graf graf--p graf-after--p">There are may ways the ABCI can be implemented, including with in-process functions, a binary socket protocol, or even JSON over HTTP. We recommend a binary socket protocol, known as ABCI (formerly the Tendermint Socket Protocol (TMSP)) for connecting Tendermint to an application running in another process. There can be multiple ABCI connections to an application. Tendermint Core creates three ABCI connections to the application; one for the validation of transactions when broadcasting in the mempool, one for the consensus engine to run block proposals, and one for querying information from the app.</p><p name="d9ab" id="d9ab" class="graf graf--p graf-after--p">It’s probably evident that applications designers need to very carefully design their message handlers to create a blockchain that does anything useful but this architecture provides a place to start.</p><h3 name="56c9" id="56c9" class="graf graf--h3 graf-after--p">A Note on Determinism</h3><p name="6ee8" id="6ee8" class="graf graf--p graf-after--h3">The logic for blockchain transaction processing must be deterministic. If the application logic weren’t deterministic, consensus would not be reached among the Tendermint Core replica nodes.</p><p name="5766" id="5766" class="graf graf--p graf-after--p">Solidity on Ethereum is a great language of choice for blockchain applications because, among other reasons, it is a completely deterministic programming language. However, it’s also possible to create deterministic applications using existing popular languages like Java, C++, Python, or Go. Game programmers and blockchain developers are already familiar with creating deterministic programs by avoiding sources of non-determinism such as:</p><ul class="postList"><li name="6fde" id="6fde" class="graf graf--li graf-after--p">random number generators (without deterministic seeding)</li><li name="20b1" id="20b1" class="graf graf--li graf-after--li">race conditions on threads (or avoiding threads altogether)</li><li name="c35d" id="c35d" class="graf graf--li graf-after--li">the system clock</li><li name="1fef" id="1fef" class="graf graf--li graf-after--li">uninitialized memory (in unsafe programming languages like C or C++)</li><li name="52d8" id="52d8" class="graf graf--li graf-after--li"><a href="http://gafferongames.com/networking-for-game-programmers/floating-point-determinism/" data-href="http://gafferongames.com/networking-for-game-programmers/floating-point-determinism/" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">floating point arithmetic</a></li><li name="5a47" id="5a47" class="graf graf--li graf-after--li">language features that are random (e.g. map iteration in Go)</li></ul><p name="cf2b" id="cf2b" class="graf graf--p graf-after--li">While programmers can avoid non-determinism by being careful, it is also possible to create a special linter or static analyzer for each language to check for determinism. In the future we may work with partners to create such tools.</p><h3 name="3427" id="3427" class="graf graf--h3 graf-after--p">Tutorials</h3><p name="9d3a" id="9d3a" class="graf graf--p graf-after--h3">Follow these tutorials to quickly get started developing your ABCI application.</p><ol class="postList"><li name="0b9d" id="0b9d" class="graf graf--li graf-after--p"><a href="https://tendermint.com/intro/getting-started/first-abci" data-href="https://tendermint.com/intro/getting-started/first-abci" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">Run your first ABCI application</a></li><li name="9f0b" id="9f0b" class="graf graf--li graf-after--li"><a href="https://tendermint.com/docs/guides/app-development" data-href="https://tendermint.com/docs/guides/app-development" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">Learn more about the ABCI</a></li></ol><h3 name="7244" id="7244" class="graf graf--h3 graf-after--li">Contributions</h3><p name="6c26" id="6c26" class="graf graf--p graf-after--h3 graf--trailing"><em class="markup--em markup--p-em">Many thanks to </em><a href="https://medium.com/@zmanian" data-href="https://medium.com/@zmanian" class="markup--anchor markup--p-anchor" target="_blank"><em class="markup--em markup--p-em">Zaki Manian</em></a><em class="markup--em markup--p-em"> for providing the “Intro to ABCI” section</em></p></div></div></section><section name="d741" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="20f6" id="20f6" class="graf graf--p graf--leading graf--trailing"><em class="markup--em markup--p-em">Originally published at </em><a href="https://gist.github.com/8be708a1dee0bb4157d58ef753df5b76" data-href="https://gist.github.com/8be708a1dee0bb4157d58ef753df5b76" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><em class="markup--em markup--p-em">gist.github.com</em></a><em class="markup--em markup--p-em">.</em></p></div></div></section>
</section>
<footer><p class="p-tags">Tagged in <a href="https://medium.com/tag/blockchain" class="p-tag">Blockchain</a>, <a href="https://medium.com/tag/abci" class="p-tag">Abci</a>, <a href="https://medium.com/tag/bitcoin" class="p-tag">Bitcoin</a>, <a href="https://medium.com/tag/tendermint" class="p-tag">Tendermint</a>, <a href="https://medium.com/tag/consensus" class="p-tag">Consensus</a></p><p>By <a href="https://medium.com/@nylira" class="p-author h-card">Peng Zhong</a> on <a href="https://medium.com/p/f1bd8278cdd7"><time class="dt-published" datetime="2015-12-15T08:00:00.000Z">December 15, 2015</time></a>.</p><p><a href="https://medium.com/@nylira/abci-the-application-blockchain-interface-f1bd8278cdd7" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on April 23, 2018.</p></footer></article>

</body></html>